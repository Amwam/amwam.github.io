<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8" data-next-head=""/><meta name="viewport" content="width=device-width, initial-scale=1" data-next-head=""/><title data-next-head="">Using React with Web Components | AMWAM - Amit Shah</title><meta name="description" content="Dealing with legacy code can be tough, even more so if you want to slowly migrate your front end to React.  Recently I found myself in a situation whe..." data-next-head=""/><link rel="canonical" href="https://amwam.me/blog/react-web-components" data-next-head=""/><meta property="og:title" content="Using React with Web Components | AMWAM - Amit Shah" data-next-head=""/><meta property="og:description" content="Dealing with legacy code can be tough, even more so if you want to slowly migrate your front end to React.  Recently I found myself in a situation whe..." data-next-head=""/><meta property="og:url" content="https://amwam.me/blog/react-web-components" data-next-head=""/><meta property="og:type" content="article" data-next-head=""/><meta property="og:image" content="https://amwam.me/images/me.png" data-next-head=""/><meta property="og:site_name" content="AMWAM - Amit Shah" data-next-head=""/><meta name="twitter:card" content="summary" data-next-head=""/><meta name="twitter:title" content="Using React with Web Components | AMWAM - Amit Shah" data-next-head=""/><meta name="twitter:description" content="Dealing with legacy code can be tough, even more so if you want to slowly migrate your front end to React.  Recently I found myself in a situation whe..." data-next-head=""/><meta name="twitter:image" content="https://amwam.me/images/me.png" data-next-head=""/><meta property="article:published_time" content="2017-07-02" data-next-head=""/><meta property="article:author" content="Amit Shah" data-next-head=""/><link rel="alternate" type="application/rss+xml" title="RSS" href="https://amwam.me/rss.xml" data-next-head=""/><link rel="manifest" href="/manifest.json" data-next-head=""/><link rel="preload" href="/_next/static/chunks/1dd38dfe42287d23.css" as="style"/><link rel="preload" href="/_next/static/chunks/274988711c50b9b5.css" as="style"/><script type="application/ld+json" data-next-head="">{"@context":"https://schema.org","@type":"BlogPosting","headline":"Using React with Web Components","datePublished":"2017-07-02","author":{"@type":"Person","name":"Amit Shah","url":"https://amwam.me"},"publisher":{"@type":"Person","name":"Amit Shah"},"description":"Dealing with legacy code can be tough, even more so if you want to slowly migrate your front end to React.  Recently I found myself in a situation whe...","mainEntityOfPage":{"@type":"WebPage","@id":"https://amwam.me/blog/react-web-components"}}</script><link rel="stylesheet" href="/_next/static/chunks/1dd38dfe42287d23.css" data-n-g=""/><link rel="stylesheet" href="/_next/static/chunks/274988711c50b9b5.css" data-n-p=""/><noscript data-n-css=""></noscript><script src="/_next/static/chunks/041a34037a337b5e.js" defer=""></script><script src="/_next/static/chunks/36f05eb6ef3c9965.js" defer=""></script><script src="/_next/static/chunks/712756a8d1494f32.js" defer=""></script><script src="/_next/static/chunks/7db6e267ca9f038c.js" defer=""></script><script src="/_next/static/chunks/turbopack-f9c3202ec8e598bc.js" defer=""></script><script src="/_next/static/chunks/1ff83552535eb707.js" defer=""></script><script src="/_next/static/chunks/653b9ffc688b6a3e.js" defer=""></script><script src="/_next/static/chunks/turbopack-98c1391d58453be5.js" defer=""></script><script src="/_next/static/HIb3NU13VogE7WtB_cP7L/_ssgManifest.js" defer=""></script><script src="/_next/static/HIb3NU13VogE7WtB_cP7L/_buildManifest.js" defer=""></script></head><body><div id="__next"><div class="_app-module__3RcuBW__container"><a href="#main-content" class="_app-module__3RcuBW__skip-link">Skip to main content</a><nav id="Navigation-module__KYCJma__nav-bar" role="navigation" aria-label="Main navigation"><img id="Navigation-module__KYCJma__nav-display-picture" src="/images/me.200.png" alt="Amit Shah profile picture" loading="lazy"/><div id="Navigation-module__KYCJma__name" aria-label="Site owner">Amit Shah</div><div id="Navigation-module__KYCJma__nav-links"><div class="Navigation-module__KYCJma__nav-link"><a aria-label="Navigate to home page" href="/">Home</a></div><div class="Navigation-module__KYCJma__nav-link"><a aria-label="Navigate to about page" href="/about">About</a></div><div class="Navigation-module__KYCJma__nav-link"><a aria-label="Navigate to blog" href="/blog">Blog</a></div><div class="Navigation-module__KYCJma__nav-link"><a aria-label="Navigate to contact page" href="/contact">Contact</a></div></div></nav><div id="_app-module__3RcuBW__content-wrapper"><main id="main-content" class="_app-module__3RcuBW__content"><div><script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://amwam.me/"},{"@type":"ListItem","position":2,"name":"Blog","item":"https://amwam.me/blog"},{"@type":"ListItem","position":3,"name":"Using React with Web Components"}]}</script><nav aria-label="Breadcrumb" style="margin-bottom:1rem"><ol style="display:flex;list-style:none;padding:0;margin:0;gap:0.5rem"><li style="display:flex;align-items:center"><a href="/">Home</a></li><li style="display:flex;align-items:center"><span style="margin:0 0.5rem">/</span><a href="/blog">Blog</a></li><li style="display:flex;align-items:center"><span style="margin:0 0.5rem">/</span><span aria-current="page">Using React with Web Components</span></li></ol></nav><h1>Using React with Web Components</h1><div><time dateTime="2017-07-02">2 July 2017</time></div><div class="style-module__c7Ehta__tags"><span><a href="/blog?tag=javascript">javascript</a>, </span><span><a href="/blog?tag=react">react</a></span></div><p>Dealing with legacy code can be tough, even more so if you want to slowly migrate your front end to React.</p>
<p>Recently I found myself in a situation where some HTML was rendered server side, and inserted into the browser on request. I wanted to use a shiny new React component, instead of falling back to the legacy jQuery code.</p>
<p>In comes <a href="https://www.webcomponents.org">Web Components</a>!</p>
<p>Web Components allow you to write your own HTML tags, and use them through out your application. This solves my problem, by having the server render the new HTML tag, and the front end automatically load the required JavaScript to render/control it. When rendering the Web Component we can delegate the actual rendering to React.</p>
<p>Lets start with a simple React component:</p>
<pre><code class="language-JavaScript">import React from &quot;react&quot;;

class MyComponent extends React.Component {
  render() {
    return &lt;div&gt;Hello world! This was rendered using React!&lt;/div&gt;;
  }
}
</code></pre>
<p>In order to render the component, we have to create a new HTMLElement as so:</p>
<pre><code class="language-JavaScript">class CustomHTMLElement extends HTMLElement {
  connectedCallback() {
    ReactDOM.render(&lt;MyComponent /&gt;, this);
  }
}
</code></pre>
<p>In this, when the component is loaded by the browser, the <code>connectedCallback</code> will be called, allowing us to render the new component, at <code>this</code> (the location of the element in the DOM).</p>
<p>To finish, we just have to register the element with the customElements API:</p>
<pre><code class="language-JavaScript">customElements.define(&quot;x-test&quot;, CustomHTMLElement);
</code></pre>
<p>Now we can just use the tag <code>&lt;x-test/&gt;</code> in our HTML, to render the React component!</p>
<p>One problem with this setup can be <a href="https://babeljs.io">Babel</a>, as it doesn&#x27;t play nice with transforming classes and extending <code>HTMLElement</code>.
We can work around this using a custom class, and extending the prototype of HTMLElement:</p>
<pre><code class="language-JavaScript">function BabelHTMLElement() {
  const newTarget = Object.getPrototypeOf(this).constructor;
  return Reflect.construct(HTMLElement, [], newTarget);
}

Object.setPrototypeOf(BabelHTMLElement.prototype, HTMLElement.prototype);

class CustomHTMLElement extends BabelHTMLElement {
    ...
</code></pre>
<p>Now our <code>CustomHTMLElement</code> extends the <code>BabelHTMLElement</code> rather the <code>HTMLElement</code> directly.</p>
<p>To view an example project with this in use, you can checkout the repo here: <a href="https://github.com/Amwam/react-webcomponents">https://github.com/Amwam/react-webcomponents</a></p></div></main></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"POST":"Dealing with legacy code can be tough, even more so if you want to slowly migrate your front end to React.\n\nRecently I found myself in a situation where some HTML was rendered server side, and inserted into the browser on request. I wanted to use a shiny new React component, instead of falling back to the legacy jQuery code.\n\nIn comes [Web Components](https://www.webcomponents.org)!\n\nWeb Components allow you to write your own HTML tags, and use them through out your application. This solves my problem, by having the server render the new HTML tag, and the front end automatically load the required JavaScript to render/control it. When rendering the Web Component we can delegate the actual rendering to React.\n\nLets start with a simple React component:\n\n```JavaScript\nimport React from \"react\";\n\nclass MyComponent extends React.Component {\n  render() {\n    return \u003cdiv\u003eHello world! This was rendered using React!\u003c/div\u003e;\n  }\n}\n```\n\nIn order to render the component, we have to create a new HTMLElement as so:\n\n```JavaScript\nclass CustomHTMLElement extends HTMLElement {\n  connectedCallback() {\n    ReactDOM.render(\u003cMyComponent /\u003e, this);\n  }\n}\n```\n\nIn this, when the component is loaded by the browser, the `connectedCallback` will be called, allowing us to render the new component, at `this` (the location of the element in the DOM).\n\nTo finish, we just have to register the element with the customElements API:\n\n```JavaScript\ncustomElements.define(\"x-test\", CustomHTMLElement);\n```\n\nNow we can just use the tag `\u003cx-test/\u003e` in our HTML, to render the React component!\n\nOne problem with this setup can be [Babel](https://babeljs.io), as it doesn't play nice with transforming classes and extending `HTMLElement`.\nWe can work around this using a custom class, and extending the prototype of HTMLElement:\n\n```JavaScript\nfunction BabelHTMLElement() {\n  const newTarget = Object.getPrototypeOf(this).constructor;\n  return Reflect.construct(HTMLElement, [], newTarget);\n}\n\nObject.setPrototypeOf(BabelHTMLElement.prototype, HTMLElement.prototype);\n\nclass CustomHTMLElement extends BabelHTMLElement {\n    ...\n```\n\nNow our `CustomHTMLElement` extends the `BabelHTMLElement` rather the `HTMLElement` directly.\n\nTo view an example project with this in use, you can checkout the repo here: [https://github.com/Amwam/react-webcomponents](https://github.com/Amwam/react-webcomponents)\n"},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"react-web-components"},"buildId":"HIb3NU13VogE7WtB_cP7L","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>